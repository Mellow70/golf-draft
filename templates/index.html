<!DOCTYPE html>
     <html lang="en">
     <head>
         <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>{{ tournament }} Draft</title>
         <script src="https://cdn.tailwindcss.com"></script>
         <style>
             .table-container { max-height: 400px; overflow-y: auto; }
             .table-header { position: sticky; top: 0; background-color: #4a5568; color: white; }
             th, td { padding: 4px; text-align: left; white-space: nowrap; }
             th { font-weight: bold; }
             td { max-width: 0; overflow: hidden; text-overflow: ellipsis; }
         </style>
         <script>
             const draftOrder = {{ participants | tojson }};
             let lastPickCount = {{ picks | length }};

             function checkForUpdates() {
                 fetch('/draft_state')
                     .then(response => response.json())
                     .then(data => {
                         if (data.picks.length > lastPickCount) {
                             lastPickCount = data.picks.length;
                             location.reload();
                         }
                     })
                     .catch(error => console.error("Update check error:", error));
             }

             window.onload = function() {
                 setInterval(checkForUpdates, 2000); // Check every 2 seconds
                 const table = document.getElementById('playersTable');
                 const data = {{ player_picks | tojson }};
                 const sortedPlayers = draftOrder.filter(player => player in data);
                 sortedPlayers.forEach(player => {
                     const row = document.createElement('tr');
                     row.innerHTML = `
                         <td class="border px-2 py-1">${player}</td>
                         <td class="border px-2 py-1">${data[player].map(p => p.Golfer).join(', ') || 'N/A'}</td>
                     `;
                     table.querySelector('tbody').appendChild(row);
                 });
             };
         </script>
     </head>
     <body class="bg-gray-100 p-5">
         <header class="bg-green-800 text-white p-4 text-xl font-bold">
             {{ tournament }} Draft
         </header>
         <p class="mt-2">Logged in as: {{ username }} | <a href="/logout" class="text-blue-500">Logout</a></p>
         {% if draft_complete %}
             <h1 class="text-2xl font-bold mt-4">Draft Complete!</h1>
             <p class="mt-2">Thank you for participating. Check back for final results.</p>
         {% else %}
             <h1 class="text-2xl font-bold mt-4">Current Turn: {{ current_player }}</h1>
             <p class="mt-2">Pick #{{ current_pick_number }} | Time Left: {{ timer_seconds }} seconds</p>
             {% if username and USER_PLAYER_MAPPING[username] == current_player %}
                 <form id="pickForm" method="POST" action="/pick" class="mt-4">
                     <select name="golfer" class="p-2 border rounded">
                         {% for golfer in golfers %}
                             <option value="{{ golfer }}">{{ golfer }}</option>
                         {% endfor %}
                     </select>
                     <button type="submit" class="ml-2 p-2 bg-blue-500 text-white rounded">Submit Pick</button>
                 </form>
             {% else %}
                 <p class="mt-2">Not your turn—please wait!</p>
             {% endif %}
         {% endif %}
         <h2 class="text-xl font-bold mt-4">Players Picks</h2>
         <div class="table-container mt-2">
             <table id="playersTable" class="w-full border-collapse border">
                 <thead>
                     <tr class="table-header">
                         <th class="border px-2 py-1">Player</th>
                         <th class="border px-2 py-1">Picks</th>
                     </tr>
                 </thead>
                 <tbody></tbody>
             </table>
         </div>
         <div id="instructions" class="mt-4 p-4 bg-yellow-100 border border-yellow-400 rounded">
             <h3 class="font-bold">Instructions</h3>
             <ul class="list-disc pl-5">
                 <li>Welcome to the draft!</li>
                 <li>Starts at 8 PM on {{ draft_date }} based on the listed order.</li>
                 <li>Log in with your username—pick only on your turn.</li>
                 <li>5-minute timer per pick; auto-pick selects the highest-ranked golfer if missed.</li>
                 <li>Select 3 golfers total.</li>
                 <li>Winner takes all; if no winner, highest-ranking golfer decides.</li>
                 <li>Good luck!</li>
             </ul>
         </div>
     </body>
     </html>