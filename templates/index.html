<script>    const timerSeconds = {{ timer_seconds }};    let timeLeft = timerSeconds;    let timerInterval = null;    const draftComplete = {{ draft_complete | tojson }};    const POLL_INTERVAL = 5000; // Poll every 5 seconds instead of 1-2 seconds    function startTimer() {        if (draftComplete) return;        timerInterval = setInterval(() => {            timeLeft--;            document.getElementById('timer').textContent = timeLeft;            if (timeLeft <= 0) {                clearInterval(timerInterval);                triggerAutopick();            }        }, 1000);    }    function resetTimer() {        clearInterval(timerInterval);        timeLeft = timerSeconds;        document.getElementById('timer').textContent = timeLeft;        startTimer();    }    function triggerAutopick() {        fetch('/autopick', {            method: 'POST',            headers: { 'Content-Type': 'application/x-www-form-urlencoded' }        })        .then(response => response.json())        .then(data => {            if (data.success) {                updateDraftBoard(data.player, data.golfer, data.pick_time);                updateCurrentTurn(data.player, data.golfer);            } else {                console.error('Autopick failed: ' + (data.error || 'Unknown error'));                updateCurrentTurn();            }        })        .catch(error => {            console.error('Autopick error:', error);            updateCurrentTurn();        });    }    function updateDraftBoard(player, golfer, pickTime) {        const tbody = document.getElementById('draft-board');        const row = document.createElement('tr');        row.innerHTML = `            <td class="border p-2">${player}</td>            <td class="border p-2">${golfer}</td>            <td class="border p-2">${pickTime}</td>        `;        tbody.appendChild(row);        const playerRow = Array.from(document.querySelectorAll('#players-picks tr')).find(row =>             row.cells[0].textContent === player        );        if (playerRow) {            const roundNumber = parseInt(pickTime.split(' ')[1]);            const pickCell = playerRow.cells[roundNumber];            pickCell.textContent = golfer;        }    }    function updateCurrentTurn(lastPlayer = null, lastGolfer = null) {        let attempts = 0;        const maxAttempts = 5;        const checkState = () => {            fetch('/draft_state')                .then(response => response.json())                .then(data => {                    if (data.error) {                        console.error('Error fetching draft state: ' + data.error);                        if (attempts < maxAttempts) {                            attempts++;                            setTimeout(checkState, POLL_INTERVAL);                        }                        return;                    }                    const lastPickFound = lastPlayer && lastGolfer && data.picks.some(p =>                         p.Player === lastPlayer && p.Golfer === lastGolfer                    );                    if (!lastPickFound && attempts < maxAttempts) {                        attempts++;                        setTimeout(checkState, POLL_INTERVAL);                        return;                    }                    const currentPlayerElement = document.getElementById('current-player');                    const currentPickNumberElement = document.getElementById('current-pick-number');                    currentPlayerElement.textContent = data.current_player || '';                    currentPickNumberElement.textContent = data.current_pick_number || '';                    const golferSelect = document.getElementById('golfer-select');                    if (golferSelect) {                        golferSelect.innerHTML = '<option value="">Select a golfer</option>';                        data.available_golfers.forEach(golfer => {                            const option = document.createElement('option');                            option.value = golfer;                            option.textContent = golfer;                            golferSelect.appendChild(option);                        });                    }                    const draftBoard = document.getElementById('draft-board');                    draftBoard.innerHTML = '';                    data.picks.forEach(pick => {                        const row = document.createElement('tr');                        row.innerHTML = `                            <td class="border p-2">${pick.Player}</td>                            <td class="border p-2">${pick.Golfer}</td>                            <td class="border p-2">${pick['Pick Time']}</td>                        `;                        draftBoard.appendChild(row);                    });                    const playersPicks = document.getElementById('players-picks');                    playersPicks.innerHTML = '';                    Object.keys(data.player_picks).forEach(player => {                        const row = document.createElement('tr');                        const picks = data.player_picks[player];                        const pick1 = picks.find(p => p['Pick Time'] === 'Round 1 (No timestamp)')?.Golfer || '';                        const pick2 = picks.find(p => p['Pick Time'] === 'Round 2 (No timestamp)')?.Golfer || '';                        const pick3 = picks.find(p => p['Pick Time'] === 'Round 3 (No timestamp)')?.Golfer || '';                        row.innerHTML = `                            <td class="border p-2">${player}</td>                            <td class="border p-2">${pick1}</td>                            <td class="border p-2">${pick2}</td>                            <td class="border p-2">${pick3}</td>                        `;                        playersPicks.appendChild(row);                    });                    if (data.draft_complete) {                        location.reload();                    } else {                        resetTimer();                    }                })                .catch(error => {                    console.error('Error fetching draft state:', error);                    if (attempts < maxAttempts) {                        attempts++;                        setTimeout(checkState, POLL_INTERVAL);                    } else {                        resetTimer();                    }                });        };        checkState();    }    document.getElementById('pick-button')?.addEventListener('click', () => {        const golfer = document.getElementById('golfer-select').value;        if (!golfer) {            alert('Please select a golfer');            return;        }        fetch('/pick', {            method: 'POST',            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },            body: `golfer=${encodeURIComponent(golfer)}`        })        .then(response => response.json())        .then(data => {            if (data.success) {                updateDraftBoard(data.player, data.golfer, data.pick_time);                updateCurrentTurn(data.player, data.golfer);            } else {                alert('Pick failed: ' + (data.error || 'Unknown error'));                updateCurrentTurn();            }        })        .catch(error => {            console.error('Pick error:', error);            updateCurrentTurn();        });    });    if (!draftComplete) {        startTimer();    }</script>